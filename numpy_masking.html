<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;500;600;700&display=swap');
    
    .slide-container {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      width: 100vw;
      min-height: 100vh;
      background: #F2F9FC;
      color: #858481;
      font-family: 'SF Pro Display', sans-serif;
    }
    .title {
      color: #12377A;
      font-size: 36px;
      font-weight: bold;
      font-family: 'Inter', sans-serif;
    }
    .subtitle {
      color: #12377A;
      font-size: 24px;
      font-weight: 500;
      font-family: 'Inter', sans-serif;
    }
    .body-text {
      font-size: 18px;
      line-height: 1.6;
    }
    .highlight {
      color: #12377A;
      font-weight: 600;
    }
    .code-example {
      background-color: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 16px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 14px;
      margin: 12px 0;
      overflow-x: auto;
      line-height: 1.8;
      white-space: pre-line;
    }
    .array-visualization {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 12px;
      border: 2px solid rgba(18, 55, 122, 0.2);
    }
    .array-cell {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(18, 55, 122, 0.1);
      border: 2px solid #12377A;
      border-radius: 8px;
      padding: 12px;
      margin: 4px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      font-weight: bold;
      color: #12377A;
      min-width: 60px;
      animation: glow 2s infinite;
    }
    .array-index {
      font-size: 12px;
      color: #666;
      margin-bottom: 4px;
    }
    .array-value {
      font-size: 16px;
    }
    .array-2d {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin: 20px 0;
    }
    .array-2d-cell {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(18, 55, 122, 0.1);
      border: 2px solid #12377A;
      border-radius: 8px;
      padding: 12px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      font-weight: bold;
      color: #12377A;
      min-height: 60px;
      animation: glow 2s infinite;
    }
    .array-2d-index {
      font-size: 10px;
      color: #666;
      margin-bottom: 4px;
    }
    .array-2d-value {
      font-size: 14px;
    }
    .masking-demo {
      background: rgba(255, 255, 255, 0.8);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      border: 2px solid rgba(18, 55, 122, 0.2);
    }
    .array-visual {
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      gap: 8px;
      margin: 20px 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 12px;
      border: 2px solid rgba(18, 55, 122, 0.2);
    }
    .array-cell.masked {
      background: rgba(220, 53, 69, 0.2);
      border-color: #dc3545;
      color: #dc3545;
      opacity: 0.6;
    }
    .array-cell.selected {
      background: rgba(40, 167, 69, 0.3);
      border-color: #28a745;
      color: #155724;
      transform: scale(1.05);
      box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
    }
    .boolean-cell {
      background: rgba(255, 193, 7, 0.2);
      border-color: #ffc107;
      color: #856404;
    }
    .boolean-cell.true {
      background: rgba(40, 167, 69, 0.3);
      border-color: #28a745;
      color: #155724;
    }
    .boolean-cell.false {
      background: rgba(220, 53, 69, 0.2);
      border-color: #dc3545;
      color: #721c24;
    }
    .step-container {
      margin: 20px 0;
      padding: 15px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      border-left: 4px solid #12377A;
    }
    .step-title {
      font-size: 18px;
      font-weight: 600;
      color: #12377A;
      margin-bottom: 15px;
    }
    .arrow {
      text-align: center;
      font-size: 24px;
      color: #12377A;
      margin: 20px 0;
      font-weight: bold;
    }
    .result-array {
      background: rgba(40, 167, 69, 0.1);
      border: 2px solid #28a745;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
      font-family: 'Courier New', monospace;
      font-size: 16px;
      text-align: center;
      color: #155724;
      font-weight: bold;
    }
    .interactive-code {
      margin: 12px 0;
    }
    .code-editor {
      width: 100%;
      min-height: 120px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 14px;
      padding: 12px;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      background-color: #f8f9fa;
      resize: vertical;
      line-height: 1.5;
    }
    .run-button {
      background-color: #12377A;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      margin: 8px 0;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .run-button:hover {
      background-color: #0d2a5f;
      transform: translateY(-1px);
    }
    .run-button:active {
      transform: translateY(0);
    }
    .run-button:disabled {
      background-color: #6c757d;
      cursor: not-allowed;
      transform: none;
    }
    .output {
      background-color: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 12px;
      margin: 8px 0;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 14px;
      min-height: 40px;
      white-space: pre-wrap;
      overflow-x: auto;
    }
    .loading {
      color: #12377A;
      font-style: italic;
    }
    .fullscreen-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: rgba(18, 55, 122, 0.9);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 16px;
      cursor: pointer;
      font-size: 16px;
      z-index: 1000;
      transition: all 0.3s ease;
    }
    .fullscreen-btn:hover {
      background-color: rgba(18, 55, 122, 1);
      transform: scale(1.05);
    }
    .example-box {
      background: rgba(255, 255, 255, 0.8);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      border: 2px solid rgba(18, 55, 122, 0.2);
    }
    @keyframes glow {
      0%, 100% { box-shadow: 0 0 5px rgba(18, 55, 122, 0.3); }
      50% { box-shadow: 0 0 20px rgba(18, 55, 122, 0.6); }
    }
    </style>
</head>
<body>
  <button class="fullscreen-btn" onclick="toggleFullscreen()">
    <i class="fas fa-expand" id="fullscreenIcon"></i> Fullscreen
  </button>
  <div class="slide-container p-10">
    <h1 class="title mb-6">NumPy Masking with Boolean Arrays</h1>
    
    <div class="body-text mb-6">
      <p><span class="highlight">Masking</span> is a powerful technique in NumPy that allows you to select specific elements from an array based on conditions. It uses boolean arrays (masks) to determine which elements to keep and which to ignore.</p>
    </div>

    <div class="masking-demo">
      <h2 class="subtitle mb-4">Step-by-Step Masking Process</h2>
      
      <div class="step-container">
        <div class="step-title">Step 1: Original Array</div>
        <div class="array-visual" id="originalArray">
          <!-- Original array cells will be generated by JavaScript -->
        </div>
      </div>

      <div class="arrow">↓</div>

      <div class="step-container">
        <div class="step-title">Step 2: Create Boolean Mask (Condition)</div>
        <div class="body-text mb-4">
          <p>We create a boolean array where <span class="highlight">True</span> means "select this element" and <span class="highlight">False</span> means "ignore this element".</p>
        </div>
        <div class="array-visual" id="booleanMask">
          <!-- Boolean mask cells will be generated by JavaScript -->
        </div>
      </div>

      <div class="arrow">↓</div>

      <div class="step-container">
        <div class="step-title">Step 3: Apply Mask to Get Selected Elements</div>
        <div class="body-text mb-4">
          <p>NumPy returns only the elements where the mask is <span class="highlight">True</span>.</p>
        </div>
        <div class="array-visual" id="maskedArray">
          <!-- Masked array cells will be generated by JavaScript -->
        </div>
        <div class="result-array" id="resultArray">
          <!-- Result will be shown here -->
        </div>
      </div>
    </div>

    <div>
      <h2 class="subtitle mb-4">Common Masking Examples</h2>
        
        <div class="example-box">
          <h3 class="highlight text-lg mb-3">1. Select elements greater than 5</h3>
          <div class="interactive-code">
            <textarea class="code-editor" id="masking1Code">import numpy as np

# Create array and condition
arr = np.array([1, 7, 3, 9, 2, 8])
mask = arr > 5
result = arr[mask]
print("Original:", arr)
print("Mask (>5):", mask)
print("Result:", result)  # [7, 9, 8]</textarea>
            <button class="run-button" onclick="runPythonCode('masking1Code', 'masking1Output')">
              <i class="fas fa-play"></i> Run Code
            </button>
            <div class="output" id="masking1Output">Click "Run Code" to execute the Python code above</div>
          </div>
        </div>

        <div class="example-box">
          <h3 class="highlight text-lg mb-3">2. Select even numbers</h3>
          <div class="interactive-code">
            <textarea class="code-editor" id="masking2Code">import numpy as np

arr = np.array([1, 2, 3, 4, 5, 6])
mask = arr % 2 == 0
result = arr[mask]
print("Even numbers:", result)  # [2, 4, 6]</textarea>
            <button class="run-button" onclick="runPythonCode('masking2Code', 'masking2Output')">
              <i class="fas fa-play"></i> Run Code
            </button>
            <div class="output" id="masking2Output">Click "Run Code" to execute the Python code above</div>
          </div>
        </div>

        <div class="example-box">
          <h3 class="highlight text-lg mb-3">3. Select elements between 3 and 7</h3>
          <div class="interactive-code">
            <textarea class="code-editor" id="masking3Code">import numpy as np

arr = np.array([1, 5, 2, 8, 3, 6, 4])
mask = (arr >= 3) & (arr <= 7)
result = arr[mask]
print("Between 3-7:", result)  # [5, 3, 6, 4]</textarea>
            <button class="run-button" onclick="runPythonCode('masking3Code', 'masking3Output')">
              <i class="fas fa-play"></i> Run Code
            </button>
            <div class="output" id="masking3Output">Click "Run Code" to execute the Python code above</div>
          </div>
        </div>
    </div>

  </div>

<script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
<script>
let pyodide = null;

async function initializePyodide() {
  if (pyodide) return;
  
  try {
    pyodide = await loadPyodide();
    await pyodide.loadPackage("numpy");
    console.log("Pyodide and NumPy loaded successfully");
  } catch (error) {
    console.error("Error loading Pyodide:", error);
    // Fallback: try micropip
    try {
      await pyodide.loadPackage("micropip");
      const micropip = pyodide.pyimport("micropip");
      await micropip.install("numpy");
      console.log("NumPy installed via micropip");
    } catch (micropipError) {
      console.error("Error installing NumPy via micropip:", micropipError);
    }
  }
}

async function runPythonCode(codeId, outputId) {
  const codeElement = document.getElementById(codeId);
  const outputElement = document.getElementById(outputId);
  const button = codeElement.nextElementSibling;
  
  if (!codeElement || !outputElement) {
    console.error("Code or output element not found");
    return;
  }
  
  const code = codeElement.value;
  if (!code.trim()) {
    outputElement.textContent = "Please enter some code to run.";
    return;
  }
  
  // Initialize Pyodide if not already done
  if (!pyodide) {
    outputElement.textContent = "Loading Python environment...";
    button.disabled = true;
    await initializePyodide();
    button.disabled = false;
  }
  
  if (!pyodide) {
    outputElement.textContent = "Failed to load Python environment. Please refresh the page.";
    return;
  }
  
  try {
    button.disabled = true;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Running...';
    outputElement.textContent = "Running code...";
    
    // Clear previous output
    pyodide.runPython(`
import sys
from io import StringIO
sys.stdout = StringIO()
sys.stderr = StringIO()
`);
    
    // Run the user code
    pyodide.runPython(code);
    
    // Capture output
    const stdout = pyodide.runPython("sys.stdout.getvalue()");
    const stderr = pyodide.runPython("sys.stderr.getvalue()");
    
    // Restore stdout/stderr
    pyodide.runPython(`
import sys
sys.stdout = sys.__stdout__
sys.stderr = sys.__stderr__
`);
    
    if (stderr) {
      outputElement.textContent = `Error: ${stderr}`;
      outputElement.style.color = "#dc3545";
    } else {
      outputElement.textContent = stdout || "Code executed successfully (no output)";
      outputElement.style.color = "#333";
    }
    
  } catch (error) {
    outputElement.textContent = `Error: ${error.message}`;
    outputElement.style.color = "#dc3545";
  } finally {
    button.disabled = false;
    button.innerHTML = '<i class="fas fa-play"></i> Run Code';
  }
}

function toggleFullscreen() {
  const btn = document.getElementById('fullscreenBtn');
  const icon = document.getElementById('fullscreenIcon');
  
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen().then(() => {
      icon.className = 'fas fa-compress';
      btn.innerHTML = '<i class="fas fa-compress"></i> Exit Fullscreen';
    }).catch(err => {
      console.log('Error attempting to enable fullscreen:', err.message);
    });
  } else {
    document.exitFullscreen().then(() => {
      icon.className = 'fas fa-expand';
      btn.innerHTML = '<i class="fas fa-expand"></i> Fullscreen';
    }).catch(err => {
      console.log('Error attempting to exit fullscreen:', err.message);
    });
  }
}

// Listen for fullscreen changes
document.addEventListener('fullscreenchange', () => {
  const btn = document.getElementById('fullscreenBtn');
  const icon = document.getElementById('fullscreenIcon');
  
  if (!document.fullscreenElement) {
    icon.className = 'fas fa-expand';
    btn.innerHTML = '<i class="fas fa-expand"></i> Fullscreen';
  } else {
    icon.className = 'fas fa-compress';
    btn.innerHTML = '<i class="fas fa-compress"></i> Exit Fullscreen';
  }
});

// Create the visual demonstration
function createMaskingDemo() {
  const originalData = [2, 7, 1, 9, 4, 6, 3, 8, 5];
  const mask = [false, true, false, true, false, true, false, true, false];
  const selected = originalData.filter((_, i) => mask[i]);
  
  // Original array
  const originalContainer = document.getElementById('originalArray');
  originalContainer.innerHTML = '';
  originalData.forEach((value, index) => {
    const cell = document.createElement('div');
    cell.className = 'array-cell';
    cell.textContent = value;
    cell.title = `Index ${index}: ${value}`;
    originalContainer.appendChild(cell);
  });
  
  // Boolean mask
  const maskContainer = document.getElementById('booleanMask');
  maskContainer.innerHTML = '';
  mask.forEach((bool, index) => {
    const cell = document.createElement('div');
    cell.className = `array-cell boolean-cell ${bool ? 'true' : 'false'}`;
    cell.textContent = bool ? 'T' : 'F';
    cell.title = `Index ${index}: ${bool}`;
    maskContainer.appendChild(cell);
  });
  
  // Masked array (showing selection)
  const maskedContainer = document.getElementById('maskedArray');
  maskedContainer.innerHTML = '';
  originalData.forEach((value, index) => {
    const cell = document.createElement('div');
    cell.className = `array-cell ${mask[index] ? 'selected' : 'masked'}`;
    cell.textContent = value;
    cell.title = `Index ${index}: ${value} - ${mask[index] ? 'Selected' : 'Filtered out'}`;
    maskedContainer.appendChild(cell);
  });
  
  // Result array
  const resultContainer = document.getElementById('resultArray');
  resultContainer.textContent = `Result: [${selected.join(', ')}]`;
}

// Initialize the demonstration
document.addEventListener('DOMContentLoaded', () => {
  createMaskingDemo();
});
</script>
<script src="navigation.js"></script>
</body>
</html>
